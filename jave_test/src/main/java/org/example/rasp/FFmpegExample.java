package org.example.rasp;

import ws.schild.jave.process.ProcessWrapper;
import java.io.*;
public class FFmpegExample {
    public static void main(String[] args) throws IOException {

        String ffmpegExecutablePath = "curl";
        String inputFilePath = "/Users/D0L1/test/1.mp4";
        String outputFilePath = "/Users/D0L1/test/2.mp4";

        ProcessWrapper processWrapper = new ProcessWrapper(ffmpegExecutablePath);
        processWrapper.addArgument("127.0.0.1:9999/test");
        processWrapper.addArgument(inputFilePath);
        processWrapper.addArgument("-c:v");
        processWrapper.addArgument("copy");
        processWrapper.addArgument("-c:a");
        processWrapper.addArgument("aac");
        processWrapper.addArgument(outputFilePath);
//        processWrapper.addArgument("-h");
//        processWrapper.addArgument("|");
//        processWrapper.addArgument("curl");
//        processWrapper.addArgument("http://127.0.0.1:8000");
        System.out.println(processWrapper);

        InputStream errorStream = null;
        try {
            processWrapper.execute();

            Thread.sleep(10000);

            InputStream inputStream = processWrapper.getInputStream();
            OutputStream outputStream = processWrapper.getOutputStream();
            errorStream = processWrapper.getErrorStream();


            System.out.println(inputStream);
            System.out.println(outputStream);
            processWrapper.close();


        } catch (Exception e) {
            e.printStackTrace();
            BufferedReader errorReader = new BufferedReader(new InputStreamReader(errorStream));
            String line;
            while ((line = errorReader.readLine()) != null) {
                System.err.println(line);
            }

        }
    }
}
